<!DOCTYPE html>
<html lang="zh">

<link href="/static/css/rg_base.css" rel="stylesheet" type="text/css">
<link href="/static/css/photos.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="/static/jquery/dist/jquery.min.js"></script>

<script type="text/javascript" src="/static/js/rg_base.js"></script>
<script type="text/javascript" src="/static/js/bgLayout.js"></script>
<script type="text/javascript" src="/static/js/timeUtil.js"></script>
<script type="text/javascript" src="/static/js/albumPage.js"></script>
<script>
    this.ubg = "{{user.bgImage}}"
    this.style = {{user.style|default('')|tojson}}
    this.relation = {{relation}}
    this.re_relation = {{re_relation}}
    this.userId = "{{user.ID}}"
</script>
<style>
    .album_wrapper a {
        background: none left;
    }

    .album_wrapper a:hover {
        background: none left;
        color: #0e0e0e;
    }

    .album_wrapper ul, .album_wrapper li, .album_wrapper a, .album_wrapper em {
        height: 18px;
        line-height: 18px;
    }

    .album_wrapper em {
        color: #0e0e0e;
        font-size: 14px;
    }

    .album_wrapper a:hover em {
        color: #222;
        font-weight: bolder;
    }

    .add_album em {
        background: url('/static/image/add_album.png') no-repeat;
        background-size: contain;
    }

    .manager_album em {
        background: url('/static/image/manager_album.png') no-repeat;
        background-size: contain;
    }

    .album_select {
        display: none;
        width: 20px;
        height: 20px;
        background: url('/static/image/select-off.png') no-repeat;
        background-size: contain;
        position: absolute;
        margin-top: 5px;
        margin-left: 5px;
    }
</style>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=1.0, user-scalable=yes"/>
    <title>相册</title>
</head>
<body>
<div class="boprt a-control" style="top: 20px; opacity: 1;">
    <ul>
        <li>
            {%- if home -%}
            <form><a href="/blog/edit" class="boprt09" target="_top"><em>写日志</em></a></form>
            {%- elif user -%}
            <form><a id="followItem" target="_top"><em></em></a></form>
            {%- endif -%}
        </li>
        <li>
            {%- if home -%}
            <form><a href="/user/set" class="boprt05" target="_top"><em>设置</em></a></form>
            {%- else -%}
            <form><a href="/" class="boprt01" target="_top"><em>回家</em></a></form>
            {%- endif -%}
        </li>
    </ul>
</div>

<div id="album_page" class="page_wrapper">

    <div class="page_wrapper titleWrapper">
        <h1 class="auto_text pageTitle {% if home %}editEnableWrapper{% endif %}"
            contenteditable="{% if home %}true{%else%}false{%endif%}"
            id='title'
            onblur="editName(this)"
            onfocus="recordName(this)"
            placeholder="博客标题">
            {{-user.title-}}
        </h1>
        <h3 class="auto_text pageTitle {% if home %}editEnableWrapper{% endif %}"
            contenteditable="{% if home %}true{%else%}false{%endif%}"
            id='desc'
            onblur="editDesc(this)"
            onfocus="recordDesc(this)"
            placeholder="博客描述">
            {{-user.desc-}}
        </h3>
    </div>

    {%- if user -%}
    <div style="margin-bottom: 20px;" class="toolBarWrapper">
        <a href="/blog/{{user.ID}}/" class="toolBarItem">日志</a>
        <a href="/photo/{{user.ID}}/" class="toolBarItem toolBarItem-selected">相册</a>
        {% if home %}
        <a href="/blog/view/{{user.ID}}/" class="toolBarItem">归档</a>
        <a href="/user/friends" class="toolBarItem">好友</a>
        <a class="toolBarItem">导入</a>
        {% endif %}
    </div>
    {%- endif -%}

    {%- if list -%}
    <div class="wrapperBg wrapperPadding">
        <div style="height: 25px;">
            <div class="boprt a-control" style="position: relative;float: right">
                <ul>
                    <li>
                        {%- if home -%}
                        <form class="album_wrapper add_album"><a onclick="new_album(this)" >
                            <em>创建相册</em>
                        </a></form>
                        {%- endif -%}
                    </li>
                    <li>
                        {%- if home -%}
                        <form class="album_wrapper manager_album"><a onclick="manage_album()" >
                            <em>管理相册</em>
                        </a></form>
                        {%- endif -%}
                    </li>
                </ul>
            </div>
        </div>
        <div class="collectionView" style="margin-top: 20px">
            {%- for item in list -%}
            <div id={{item.id}} class="collectionCell collectionWrap wrapperItemBg" style="margin: 10px;">
                {%- if item.id != user.defaultAlbumId -%}
                <div class="album_select"></div>
                {%- endif -%}
                <div onclick="goto_album(this)" class="bgNoRepeatImage" style="background-image: url('{%-if item.coverUrl -%}{{item.coverUrl}}{%-else-%}{{item.lastPicUrl}}{%-endif-%}'); width: 100%;">

                </div>
                <div class="p_title nowrapText">
                    {%- if item.title -%}
                        {{ item.title }}
                    {%- else -%}
                        <script>
                            var timeStamp = {{item.timestamp}}
                            var time = (new Date(timeStamp)).Format("yyyy年 MM月 dd日")
                            var dom = document.getElementById('{{item.id}}').getElementsByClassName('p_title nowrapText')[0]
                            dom.innerText = time
                        </script>
                    {%- endif -%}
                </div>
                <div class="p_desc nowrapText"> {{ item.description }}</div>
                <div class="p_desc nowrapText secondTextColor" style="margin-top: 10px">
                    <script>
                        var timeStamp = {{item.timestamp}}
                        var time = (new Date(timeStamp)).Format("yyyy MM dd hh:mm:ss")
                        var dom = document.getElementById('{{item.id}}').getElementsByClassName('p_desc nowrapText secondTextColor')[0]
                        dom.innerText = time
                    </script>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {%- endif -%}
</div>

<div id="del_button" onclick="del_albums(this)" class="rgButton" style="position: fixed; bottom: -64px; width: 100%; height: 64px; display: none"> 删除 </div>
</body>
</html>